# Architecture

```
                              +--------------------------------+
                              |          Application          |
                              +--------------------------------+
                                          ^      |
                                          |      v
            +-----------------------------+--------+------------------------------+
            |                            ANLI Core Engine                         |
            | +-----------+  +-----------+  +--------------+  +----------------+  |
            | |           |  |           |  |              |  |                |  |
 User Input | |   NLU     +--> Dialog    +--> Integration  +--> Command        |  | Application
 (Text) --->| | Interface |  | Manager   |  | Layer        |  | Execution      |  | Functions
            | |           |  |           |  |              |  |                |  |
            | +-----------+  +-----------+  +-----+--------+  +--------+-------+  |
            |                                     |                    |          |
            |                                     |                    |          |
            |                                +----+--------+           |          |
            |                                | Responses & |           |          |
            |                                | Explanations|           |          |
            |                                | Generator   |           |          |
            |                                +-------------+           |          |
            +----------------------------------------------------------+----------+
```

## Components:
NLU Interface: This component handles natural language understanding. It processes user input to extract intents, entities, and commands. This component communicates with an LLM chosen by the developer.

Dialog Manager: This is the component that manages the conversation context. It keeps track of the current context and manages multi-turn interactions. It works in tandem with the NLU interface to determine if further clarification is required from the user.

Integration Layer: This is where ANLI interacts with the application's functions. The integration layer uses the information provided by decorators to map user intents to specific functions and validate inputs.

Command Execution: Once the intents are identified and necessary information is obtained, this component calls the corresponding function in the application with the structured input.

Responses & Explanations Generator: The dialog manager uses this component to communicate with the user. It generates responses based on the conversation context, user queries, and the documentation provided for functions (e.g., docstrings).

## Flow:
The user (or a conversational agent) sends a text input to the ANLI core engine.
The NLU Interface processes the input and extracts relevant intents and entities from the natural language.
The Dialog Manager determines whether the user's intent is clear and whether the necessary information to execute a command is present. It manages the dialogue state and may request more information if required.
The Integration Layer verifies that the information collected satisfies the requirements of the intended function. If not, it informs the Dialog Manager to request further information from the user.
Once all required information is collected, the Command Execution component invokes the appropriate application function with the structured input.
The user receives a response generated by Responses & Explanations Generator, which may include confirmation of actions taken, results from the function invocation, or additional guidance and explanations as needed.
